import{r as t,A as j,S as v,j as e,L as b,g as y}from"./index-iPB-1_v2.js";import{y as i,L as N}from"./index-8h_sTz4R.js";function k(){const[o,m]=t.useState(""),{login:u}=t.useContext(j),n=t.useContext(v),[l,a]=t.useState(!1),c=t.useRef(null),[g,x]=t.useState(0),h=async r=>{r.preventDefault(),a(!0),c.current=setTimeout(()=>{a(!1),i.info("La sesión de validación ha expirado.")},5*60*1e3),n.emit("login",o,s=>{s.ok?i.success(s.msg):(i.error(s.msg),a(!1),clearTimeout(c.current))})};return t.useEffect(()=>(n.on("verified",async r=>{var s,d;if(r.ok)try{n.emit("received-verified"),await u(o),clearTimeout(c.current),a(!1)}catch(f){const p=((d=(s=f.response)==null?void 0:s.data)==null?void 0:d.error)||f.message;i.error("Error al iniciar sesión: "+p),a(!1)}else i.error(r.msg),a(!1)}),()=>{n.off("verified"),clearTimeout(c.current)}),[n,o,u]),t.useEffect(()=>{(async()=>{try{const s=await y();x(s.data.firstBonus)}catch(s){console.error("Error fetching variables:",s)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:h,children:[e.jsxs("div",{className:"branding",children:[e.jsx("div",{className:"branding-icon",children:"🎲"}),e.jsx("h1",{className:"titulo-profesional",children:"¡Bienvenido!"}),e.jsxs("div",{style:{textAlign:"center",fontWeight:"bold"},children:["🎁 ¡Bonus ",g,"% en tu primera carga!"]})]}),e.jsx("input",{value:o,onChange:r=>m(r.target.value),className:"input",type:"text",placeholder:"Usuario",required:!0}),e.jsxs("div",{className:"btn-group",children:[e.jsx("button",{type:"submit",className:`btn ${l?"gray":""}`,disabled:l,children:l?"Validando...":"Ingresar"}),e.jsxs("div",{className:"link-group",children:[e.jsx("span",{children:"¿No tienes una cuenta? "}),e.jsx(b,{to:"/register",children:"Registrarse"})]})]})]}),e.jsx(N,{})]})}export{k as default};
