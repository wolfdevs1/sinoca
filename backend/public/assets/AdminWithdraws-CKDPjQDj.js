import{r as c,b as A,j as e,d as T,e as R,f as W}from"./index-CpsQ9dQw.js";import{N as f}from"./react-number-format.es-D0UjZICv.js";function q(){const[b,S]=c.useState([]),[d,y]=c.useState([]),[r,o]=c.useState({}),[h,k]=c.useState(1),C=10,[t,l]=c.useState({searchTerm:"",filterStatus:"pending",page:1}),_=A();c.useEffect(()=>{(async()=>{try{const[{data:s},{data:n}]=await Promise.all([T(t.page,C,t.searchTerm),R()]),{withdraws:j,pages:E}=s;S(j),k(E),y(n);const g={};j.forEach(v=>{var N;g[v._id]=v.withdrawAccount||((N=n[0])==null?void 0:N.name)||""}),o(g)}catch(s){console.error(s)}})()},[t]);const P=a=>{l(s=>({...s,searchTerm:a,page:1}))},m=a=>{l(s=>({...s,filterStatus:a,page:1}))},x=a=>{l(s=>({...s,page:a}))},p=(a,s)=>{o(n=>({...n,[a]:s}))},u=async a=>{const s=r[a];if(!s){alert("Por favor selecciona un banco antes de enviar el retiro.");return}try{await W({withdrawId:a,withdrawAccount:s}),l(n=>({...n}))}catch(n){console.error("Error al cambiar estado del retiro:",n)}},i=b.filter(a=>t.filterStatus==="pending"&&!a.state||t.filterStatus==="completed"&&a.state),B=()=>{_("/admin")};return e.jsxs("div",{className:"admin-container",children:[e.jsxs("div",{className:"admin-header",children:[e.jsxs("button",{onClick:B,style:{background:"rgba(31, 41, 55, 0.8)",border:"1px solid rgba(75, 85, 99, 0.5)",borderRadius:"8px",padding:"8px 12px",color:"#e5e7eb",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease"},children:[e.jsx("span",{style:{fontSize:"16px"},children:"←"}),e.jsx("span",{children:"Volver"})]}),e.jsx("div",{className:"titulo-profesional",children:"Retiros"})]}),e.jsxs("div",{className:"admin-controls",children:[e.jsx("div",{className:"search-container",children:e.jsx("input",{type:"text",className:"search-input",placeholder:"Buscar...",value:t.searchTerm,onChange:a=>P(a.target.value)})}),e.jsxs("div",{className:"filter-container",children:[e.jsx("button",{className:`filter-btn ${t.filterStatus==="pending"?"active":""}`,onClick:()=>m("pending"),children:"Pendientes"}),e.jsx("button",{className:`filter-btn ${t.filterStatus==="completed"?"active":""}`,onClick:()=>m("completed"),children:"Completados"})]})]}),e.jsx("div",{className:"table-container desktop-view",children:i.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:"No hay retiros que coincidan con los filtros"})}):e.jsxs("table",{className:"retiros-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Usuario"}),e.jsx("th",{children:"Alias"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Cuenta Pago"}),e.jsx("th",{children:"Seleccione"}),e.jsx("th",{children:"Enviar"})]})}),e.jsx("tbody",{children:i.map(a=>e.jsxs("tr",{className:a.state?"completed":"pending",children:[e.jsx("td",{className:"user-name",children:a.name}),e.jsx("td",{className:"user-name",children:a.account}),e.jsx("td",{className:"amount",children:e.jsx(f,{value:a.amount,displayType:"text",thousandSeparator:".",decimalSeparator:",",prefix:"$"})}),e.jsx("td",{className:"user-name",children:a.withdrawAccount}),e.jsx("td",{className:"bank-select-cell",children:e.jsxs("select",{className:"bank-select",value:r[a._id]||"",onChange:s=>p(a._id,s.target.value),children:[e.jsx("option",{value:""}),d.map(s=>e.jsx("option",{value:s.name,children:s.name},s._id))]})}),e.jsx("td",{className:"send-cell",children:e.jsx("button",{className:"send-btn",onClick:()=>u(a._id),children:"Enviar"})})]},a._id))})]})}),e.jsx("div",{className:"mobile-view",children:i.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:"No hay retiros que coincidan con los filtros"})}):e.jsx("div",{className:"cards-container",children:i.map(a=>e.jsxs("div",{className:`withdraw-card ${a.state?"completed":"pending"}`,children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"user-info",children:e.jsx("h3",{className:"card-user-name",children:a.name})}),e.jsx("div",{className:"user-info",children:e.jsx("h3",{className:"card-user-name",children:a.account})}),e.jsx("div",{className:"card-amount",children:e.jsx(f,{value:a.amount,displayType:"text",thousandSeparator:".",decimalSeparator:",",prefix:"$"})})]}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"card-field",children:[e.jsx("label",{className:"card-label",children:"Cuenta de Pago:"}),e.jsx("select",{className:"bank-select",value:r[a._id]||"",onChange:s=>p(a._id,s.target.value),children:d.map(s=>e.jsx("option",{value:s.name,children:s.name},s._id))})]})}),e.jsx("div",{className:"card-footer",children:e.jsx("button",{className:"card-send-btn",onClick:()=>u(a._id),children:"Enviar Pago"})})]},a._id))})}),e.jsxs("div",{className:"pagination",children:[e.jsx("button",{disabled:t.page<=1,onClick:()=>x(t.page-1),children:"←"}),e.jsxs("span",{children:[" ",t.page," / ",h," "]}),e.jsx("button",{disabled:t.page>=h,onClick:()=>x(t.page+1),children:"→"})]})]})}export{q as default};
