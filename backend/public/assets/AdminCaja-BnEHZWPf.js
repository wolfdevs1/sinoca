import{r as n,d as E,j as e,f as D,m as N,n as T,o as y,p as C}from"./index-B_gQLNW1.js";function F(){const[j,v]=n.useState({cuenta1:0}),[d,b]=n.useState({ingreso:0,egreso:0,retiro:0,aporte:0}),[r,m]=n.useState(""),[u,h]=n.useState({cuenta:"",importe:"",descripcion:""}),w=E(),[k,S]=n.useState([]);n.useEffect(()=>{document.body.style.overflow=r?"hidden":"auto"},[r]),n.useEffect(()=>{(async()=>{try{const[{data:s},{data:t},{data:o}]=await Promise.all([D(),N(),T()]),i={...t};s.forEach(c=>{c.name in i||(i[c.name]=0)}),v(i),S(s),b(o)}catch(s){console.error("Error al cargar datos de caja:",s)}})()},[]);const A=()=>{w("/admin")},p=a=>{m(s=>s===a?"":a),h({cuenta:"",importe:"",descripcion:""})},x=(a,s)=>{h(t=>({...t,[a]:s}))},R=async(a,s)=>{a.preventDefault();const{cuenta:t,importe:o,descripcion:i}=u,c=parseFloat(o);if(!t||isNaN(c)||c<=0){alert("Por favor completa todos los campos correctamente");return}try{s==="ingreso"?await y({name:i||"Ingreso manual",amount:o,account:t}):s==="egreso"?await C({name:i||"Egreso manual",amount:o,withdrawAccount:t}):s==="aporte"?await y({name:"Aporte",amount:o,account:t}):s==="retiro"&&await C({name:"Retiro",amount:o,withdrawAccount:t});const{data:g}=await N();v(g),b(f=>({...f,[s]:f[s]+c})),h({cuenta:"",importe:"",descripcion:""}),m("")}catch(g){console.error("Error al procesar transacción:",g),alert("Ocurrió un error al guardar el movimiento")}};Object.values(j).reduce((a,s)=>a+s,0);const l=a=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(a);return e.jsxs(e.Fragment,{children:[r&&e.jsx("div",{className:"modal-overlay active",onClick:()=>m(""),children:e.jsxs("form",{className:"modal-formulario",onClick:a=>a.stopPropagation(),onSubmit:a=>R(a,r),children:[e.jsx("button",{type:"button",onClick:()=>m(""),style:{position:"absolute",top:"10px",right:"12px",background:"transparent",border:"none",fontSize:"20px",cursor:"pointer",color:"#999"},children:"×"}),e.jsxs("h3",{className:"page-title",children:["Registrar ",r.charAt(0).toUpperCase()+r.slice(1)]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Cuenta"}),e.jsxs("select",{className:"input",value:u.cuenta,onChange:a=>x("cuenta",a.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar cuenta"}),k.map(a=>e.jsxs("option",{value:a.name,children:[a.name," - ",a.bank]},a._id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Importe"}),e.jsx("input",{type:"number",className:"input",step:"0.01",min:"0",value:u.importe,onChange:a=>x("importe",a.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Descripción"}),e.jsx("textarea",{className:"input",rows:3,value:u.descripcion,onChange:a=>x("descripcion",a.target.value)})]}),e.jsx("button",{className:"btn",type:"submit",children:"Registrar"})]})}),e.jsxs("div",{className:"admin-container",children:[e.jsxs("div",{className:"admin-header",children:[e.jsxs("button",{onClick:A,style:{background:"rgba(31, 41, 55, 0.8)",border:"1px solid rgba(75, 85, 99, 0.5)",borderRadius:"8px",padding:"8px 12px",color:"#e5e7eb",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease"},onMouseEnter:a=>{a.target.style.background="rgba(55, 65, 81, 0.9)",a.target.style.borderColor="rgba(156, 163, 175, 0.7)"},onMouseLeave:a=>{a.target.style.background="rgba(31, 41, 55, 0.8)",a.target.style.borderColor="rgba(75, 85, 99, 0.5)"},children:[e.jsx("span",{style:{fontSize:"16px"},children:"←"}),e.jsx("span",{children:"Volver"})]}),e.jsx("div",{className:"titulo-profesional",children:"Caja"})]}),e.jsx("div",{className:"card",children:e.jsx("div",{children:Object.entries(j).map(([a,s])=>e.jsxs("div",{className:"cuenta-item",children:[e.jsx("h3",{children:a.toUpperCase()}),e.jsx("div",{className:"monto",children:l(s)})]},a))})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:`action-button deposit-button ${r==="ingreso"?"activo":""}`,onClick:()=>p("ingreso"),children:"Ingreso"}),e.jsx("button",{className:`action-button withdraw-button ${r==="egreso"?"activo":""}`,onClick:()=>p("egreso"),children:"Egreso"}),e.jsx("button",{className:`action-button aporte-button ${r==="aporte"?"activo":""}`,onClick:()=>p("aporte"),children:"Aporte"}),e.jsx("button",{className:`action-button logout-button ${r==="retiro"?"activo":""}`,onClick:()=>p("retiro"),children:"Retiro"})]})}),e.jsxs("div",{className:"card",style:{marginTop:"24px"},children:[e.jsx("h3",{className:"page-title",children:"Resumen Histórico"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"16px"},children:[e.jsxs("div",{className:"resumen-item ingresos",children:[e.jsx("h4",{children:"Total Ingresos"}),e.jsx("div",{className:"valor",children:l(d.ingreso)})]}),e.jsxs("div",{className:"resumen-item egresos",children:[e.jsx("h4",{children:"Total Egresos"}),e.jsx("div",{className:"valor",children:l(d.egreso)})]}),e.jsxs("div",{className:"resumen-item aportes",children:[e.jsx("h4",{children:"Total Aportes"}),e.jsx("div",{className:"valor",children:l(d.aporte)})]}),e.jsxs("div",{className:"resumen-item retiros",children:[e.jsx("h4",{children:"Total Retiros"}),e.jsx("div",{className:"valor",children:l(d.retiro)})]})]})]})]})]})}export{F as default};
