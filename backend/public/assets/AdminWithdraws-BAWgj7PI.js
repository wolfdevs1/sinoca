import{r as n,b as $,j as e,d as k,e as T,f as L}from"./index-jpmuhiA0.js";import{N as C}from"./react-number-format.es-B6ebv5sD.js";function D(){const[o,h]=n.useState({}),[m,_]=n.useState([]),[E,x]=n.useState([]),[r,P]=n.useState(""),[i,u]=n.useState("pending"),[c,l]=n.useState(1),[p,j]=n.useState(1),g=10,B=$();n.useEffect(()=>{(async()=>{try{const[{data:s},{data:t}]=await Promise.all([k(c,g,r),T()]),{withdraws:b,page:R,pages:W}=s;x(b),j(W),l(R),_(t);const f={};b.forEach(y=>{var S;f[y._id]=y.withdrawAccount||((S=t[0])==null?void 0:S.name)||""}),h(f)}catch(s){console.error(s)}})()},[c,r]);const d=E.filter(a=>i==="pending"&&!a.state||i==="completed"&&a.state),v=async a=>{const s=o[a];if(!s){alert("Por favor selecciona un banco antes de enviar el retiro.");return}try{await L({withdrawId:a,withdrawAccount:s});const{data:t}=await k(c,g);x(t.withdraws),l(t.page),j(t.pages)}catch(t){console.error("Error al cambiar estado del retiro:",t)}},N=(a,s)=>{h(t=>({...t,[a]:s}))},A=()=>{B("/admin")};return n.useEffect(()=>{l(1)},[r]),e.jsxs("div",{className:"admin-container",children:[e.jsxs("div",{className:"admin-header",children:[e.jsxs("button",{onClick:A,style:{background:"rgba(31, 41, 55, 0.8)",border:"1px solid rgba(75, 85, 99, 0.5)",borderRadius:"8px",padding:"8px 12px",color:"#e5e7eb",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease"},onMouseEnter:a=>{a.target.style.background="rgba(55, 65, 81, 0.9)",a.target.style.borderColor="rgba(156, 163, 175, 0.7)"},onMouseLeave:a=>{a.target.style.background="rgba(31, 41, 55, 0.8)",a.target.style.borderColor="rgba(75, 85, 99, 0.5)"},children:[e.jsx("span",{style:{fontSize:"16px"},children:"←"}),e.jsx("span",{children:"Volver"})]}),e.jsx("div",{className:"titulo-profesional",children:"Retiros"})]}),e.jsxs("div",{className:"admin-controls",children:[e.jsx("div",{className:"search-container",children:e.jsx("input",{type:"text",className:"search-input",placeholder:"Buscar...",value:r,onChange:a=>P(a.target.value)})}),e.jsxs("div",{className:"filter-container",children:[e.jsx("button",{className:`filter-btn ${i==="pending"?"active":""}`,onClick:()=>u("pending"),children:"Pendientes"}),e.jsx("button",{className:`filter-btn ${i==="completed"?"active":""}`,onClick:()=>u("completed"),children:"Completados"})]})]}),e.jsx("div",{className:"table-container desktop-view",children:d.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:"No hay retiros que coincidan con los filtros"})}):e.jsxs("table",{className:"retiros-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Usuario"}),e.jsx("th",{children:"Alias"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Cuenta Pago"}),e.jsx("th",{children:"Seleccione"}),e.jsx("th",{children:"Enviar"})]})}),e.jsx("tbody",{children:d.map(a=>e.jsxs("tr",{className:a.state?"completed":"pending",children:[e.jsx("td",{className:"user-name",children:a.name}),e.jsx("td",{className:"user-name",children:a.account}),e.jsx("td",{className:"amount",children:e.jsx(C,{value:a.amount,displayType:"text",thousandSeparator:".",decimalSeparator:",",prefix:"$"})}),e.jsx("td",{className:"user-name",children:a.withdrawAccount}),e.jsx("td",{className:"bank-select-cell",children:e.jsxs("select",{className:"bank-select",value:o[a._id]||"",onChange:s=>N(a._id,s.target.value),children:[e.jsx("option",{value:""}),m.map(s=>e.jsx("option",{value:s.name,children:s.name},s._id))]})}),e.jsx("td",{className:"send-cell",children:e.jsx("button",{className:"send-btn",onClick:()=>v(a._id),children:"Enviar"})})]},a._id))})]})}),e.jsx("div",{className:"mobile-view",children:d.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:"No hay retiros que coincidan con los filtros"})}):e.jsx("div",{className:"cards-container",children:d.map(a=>e.jsxs("div",{className:`withdraw-card ${a.state?"completed":"pending"}`,children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"user-info",children:e.jsx("h3",{className:"card-user-name",children:a.name})}),e.jsx("div",{className:"card-amount",children:e.jsx(C,{value:a.amount,displayType:"text",thousandSeparator:".",decimalSeparator:",",prefix:"$"})})]}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"card-field",children:[e.jsx("label",{className:"card-label",children:"Cuenta de Pago:"}),e.jsx("select",{className:"bank-select",value:o[a._id]||"",onChange:s=>N(a._id,s.target.value),children:m.map(s=>e.jsx("option",{value:s.name,children:s.name},s._id))})]})}),e.jsx("div",{className:"card-footer",children:e.jsx("button",{className:"card-send-btn",onClick:()=>v(a._id),children:"Enviar Pago"})})]},a._id))})}),e.jsxs("div",{className:"pagination",children:[e.jsx("button",{disabled:c<=1,onClick:()=>l(c-1),children:"←"}),e.jsxs("span",{children:[" ",c," / ",p," "]}),e.jsx("button",{disabled:c>=p,onClick:()=>l(c+1),children:"→"})]})]})}export{D as default};
