import{r as o,A as j,j as e,L as v,F as b,w as N,x as S}from"./index-DwHlaPch.js";import{L as E,y as n}from"./index-giiDsKKE.js";import{N as w}from"./react-number-format.es-Bb7lZ9Pb.js";function F(){const[g,d]=o.useState(""),[p,m]=o.useState(""),{user:C}=o.useContext(j),[l,h]=o.useState(!1),[c,y]=o.useState(null),[s,x]=o.useState(0);o.useEffect(()=>{if(s<=0)return;const t=setInterval(()=>x(a=>a-1),1e3);return()=>clearInterval(t)},[s]);const A=async t=>{var a,r;if(t.preventDefault(),!(l||s>0))try{h(!0);const i=parseFloat(p.toString().replace(/,/g,"")).toString();x(30);const u=await S({user:C,amount:i});n.success(u.data.message),d(""),m("")}catch(i){const u=(r=(a=i.response)==null?void 0:a.data)==null?void 0:r.error;n.error(u||"Error interno del servidor")}finally{h(!1)}},f=()=>{const t=c.alias,a="alias-copy-toast";if(navigator.clipboard)navigator.clipboard.writeText(t).then(()=>{n.success("Alias copiado al portapapeles!",{toastId:a,autoClose:2e3})}).catch(()=>{n.error("Error al copiar al portapapeles",{toastId:a,autoClose:3e3})});else{const r=document.createElement("textarea");r.style.position="absolute",r.style.left="-9999px",r.value=t,document.body.appendChild(r),r.select();try{document.execCommand("copy"),n.success("Alias copiado al portapapeles!",{toastId:a,autoClose:2e3})}catch{n.error("Error al copiar al portapapeles",{toastId:a,autoClose:3e3})}document.body.removeChild(r)}};return o.useEffect(()=>{(async()=>{try{const{data:a}=await N();y(a)}catch(a){console.error("Error al obtener usuarios:",a)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:A,children:[e.jsxs("div",{className:"form-header",children:[e.jsx(v,{to:"/",className:"circle-back-button",title:"Volver al inicio",children:e.jsx(b,{})}),e.jsx("h1",{className:"page-title",children:"CARGA"})]}),e.jsx("p",{children:"ğŸ¦ Realice la transferencia a la siguiente cuenta"}),e.jsxs("p",{className:"copy-alias",onClick:f,children:["ğŸ‘¤ TITULAR: ",c?c.name:"Cargando..."]}),e.jsxs("p",{className:"copy-alias",onClick:f,children:["ğŸ”— ALIAS: ",c?c.alias:"Cargando...",e.jsx("span",{className:"copy-icon",title:"Copiar alias",children:"ğŸ“Œ"})]}),e.jsx("p",{className:"warning",children:"âš ï¸ El ALIAS puede cambiar con el tiempo âš ï¸"}),e.jsx("p",{children:"Una vez realizada la transferencia, complete los siguientes datos ğŸ‘‡ğŸ‘‡ğŸ‘‡"}),e.jsx(w,{value:p,onValueChange:t=>{m(t.value)},prefix:"$ ",thousandSeparator:".",decimalSeparator:",",allowNegative:!1,className:"input",placeholder:"Importe transferido",required:!0}),e.jsx("input",{value:g,onChange:t=>d(t.target.value),className:"input",type:"text",placeholder:"Titular de la cuenta",required:!0}),e.jsx("div",{className:"btn-group",children:e.jsx("button",{className:`btn ${l||s>0?"gray":""}`,type:"submit",disabled:l||s>0,title:s>0?`EsperÃ¡ ${s}s para reenviar`:"Enviar",children:l?"Cargando...":s>0?`Reintentar en ${s}s`:"Cargar"})})]}),e.jsx(E,{})]})}export{F as default};
